<%

var commonmark = t.require("commonmark");
var parser = new commonmark.Parser();
var renderer = new commonmark.HtmlRenderer();

var slides = {};
json.WomenInTrades_photos.forEach(function(row) {
  if (!slides[row.slide]) slides[row.slide] = [];
  slides[row.slide].push(row);
  row.text = renderer.render(parser.parse(row.text));
});
slides = Object.keys(slides).map(function(s) { return slides[s] });

%><!doctype html>
<html>
  <head>
    <title><%= json.project.title %></title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link href='http://fonts.googleapis.com/css?family=Archivo+Narrow|Neuton:400,700' rel='stylesheet' type='text/css'>
    <%= t.include("partials/_adHead.html") %>
  </head>
  <body>

    <main class="trades-gallery">

      <header class="branding">
        <a href="http://seattletimes.com">
          <img src="./assets/st-logo.png">
        </a>
        <h1>Photo gallery</h1>
        <div class="counter"></div>
        <a class="fullscreen">VIEW FULLSCREEN</a>
      </header>

      <div class="slide-container">

        <a class="change-slide next">&raquo;</a>
        <a class="change-slide previous">&laquo;</a>

        <section class="slide intro active" data-index="intro">
          <div class="image segment">
            <img class="photo" src="assets/WomenTrades035a.jpg">
          </div>
          
            
          <div class="text segment">
            <h1 class="hed">H<span class="accent">a</span>rd at work</h1>
            <h3>A look at Seattle women <br>in traditionally masculine trades</h3>
            <div class="bylines">
              <p><em>By Susan Kelleher</em></p>
              <p><em>Photos by Bettina Hansen</em></p>
              <p><em>Development: Thomas Wilburn, Paige Collins</em></p>
            </div>
          </div>

        </section>
        

        <% slides.forEach(function(slide, i) { %>
        <section class="slide" data-index="<%= i %>">
          <% slide.forEach(function(item) { %>
            <% if (item.photo) { %>
          <div class="image segment">
              <img class="photo" src="assets/<%= item.photo %>">
            <% } else { %>
          <div class="text segment">
            <%= item.text %>
            <% } %>
          </div>
          <% }); %>
        </section>
        <% }); %>

        <section class="slide" data-index="outro">
          <div class="outro text segment">
            <h1>About this project</h1>

            <p>Susan Kelleher is a Pacific NW magazine staff writer. Reach her at <a href="mailto:skelleher@seattletimes.com">skelleher@seattletimes.com</a> or 206-464-2508. On Twitter <a href="http://twitter.com/SusanKelleher">@SusanKelleher</a>. 


            <p>Bettina Hansen is a Seattle Times staff photographer.

            <p>
              The women who posed for this story were photographed using a 4x5 camera with black and white film.

            <h2>Other stuff</h2>

            <p>
              POY and Zoe Quinn go here
            

            <p>
              <a data-jump="0" href="javascript:;">Return to start</a>
          </div>
        </section>

      </div>

      <footer class="ad">
        <%= t.include("partials/_ad.html", { type: "banner" }) %>
      </footer>

    </main>

    <script src="app.js"></script>
    <% if (json.project.production) { %>
    <%= !json.project.embedded ? t.include("partials/_adFoot.html") : "" %>
    <%= t.include("partials/_workHere.html") %>
    <% } %>
  </body>
</html>
